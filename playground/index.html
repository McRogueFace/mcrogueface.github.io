<!doctypehtml><html><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1"name=viewport><title>McRogueFace - WebGL</title><script src=https://unpkg.com/lz-string@1.5.0/libs/lz-string.min.js></script><link href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.css rel=stylesheet><link href=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/theme/dracula.min.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/codemirror.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.16/mode/python/python.min.js></script><style>*{box-sizing:border-box}body{margin:0;padding:20px;background:#1a1a2e;font-family:'Segoe UI',system-ui,sans-serif;color:#eee;min-height:100vh}.container{max-width:1500px;margin:0 auto}header{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;flex-wrap:wrap;gap:10px}.header-left{display:flex;align-items:center;gap:15px}h1{margin:0;color:#e94560}h1 a{color:inherit;text-decoration:none}.tagline{color:#666;font-size:14px}#status{color:#888}.main-content{display:flex;gap:20px;flex-wrap:wrap}.game-panel{flex:1;min-width:300px}#canvas{background:#000;display:block;max-width:100%;height:auto;image-rendering:pixelated;image-rendering:crisp-edges;-ms-interpolation-mode:nearest-neighbor;outline:0}#canvas:focus{box-shadow:0 0 10px rgba(78,204,163,.5)}.repl-panel{width:450px;min-width:350px;display:flex;flex-direction:column;background:#16213e;border-radius:8px;overflow:hidden}.repl-header{display:flex;justify-content:space-between;align-items:center;padding:10px 15px;background:#0f3460;border-bottom:1px solid #e94560;flex-wrap:wrap;gap:8px}.repl-title{display:flex;align-items:center;gap:8px}.repl-header h3{margin:0;font-size:14px;color:#e94560}.status-indicator{width:10px;height:10px;border-radius:50%;display:inline-block;transition:background-color .3s}.status-ok{background-color:#4ecca3}.status-error{background-color:#e94560}.status-busy{background-color:#f39c12}.repl-buttons{display:flex;gap:8px;align-items:center;flex-wrap:wrap}.repl-buttons button{padding:6px 12px;border:none;border-radius:4px;cursor:pointer;font-size:12px;font-weight:600;transition:all .2s}#runBtn{background:#4ecca3;color:#1a1a2e}#runBtn:hover{background:#3db892}#shareBtn{background:#667eea;color:#fff}#shareBtn:hover{background:#5a6fd6}#resetBtn{background:#e94560;color:#fff}#resetBtn:hover{background:#d63050}#clearBtn{background:#666;color:#fff}#clearBtn:hover{background:#555}.repl-buttons button:disabled{opacity:.5;cursor:not-allowed}.editor-container{border-bottom:1px solid #333}.CodeMirror{height:430px;font-size:13px;font-family:'JetBrains Mono','Fira Code',Consolas,monospace}.repl-output-header{padding:8px 15px;background:#0f3460;font-size:12px;color:#888;display:flex;justify-content:space-between;align-items:center}.shortcut-hint{font-size:11px;color:#666}#replOutput{flex:1;min-height:150px;max-height:250px;overflow-y:auto;padding:12px;background:#0a0a15;font-family:'JetBrains Mono','Fira Code',Consolas,monospace;font-size:12px;white-space:pre-wrap;color:#ccc}#replOutput .error{color:#e94560}#replOutput .success{color:#4ecca3}#replOutput .warning{color:#f39c12}#replOutput .input{color:#888}#output{margin-top:20px;width:100%;max-height:150px;overflow-y:auto;background:#0f0f23;padding:10px;font-family:monospace;font-size:12px;white-space:pre-wrap;border:1px solid #333;border-radius:4px}.spinner{margin:20px auto;width:50px;height:50px;border:5px solid #333;border-top-color:#e94560;border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.game-panel{position:relative}.click-overlay{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.85);display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:10}.click-overlay.hidden{display:none}.click-overlay h2{color:#e94560;margin:0 0 10px 0;font-size:32px}.click-overlay p{color:#888;margin:5px 15px;text-align:center}.click-overlay p a{color:#667eea}.click-overlay .start-btn{margin-top:20px;padding:15px 40px;font-size:18px;background:#4ecca3;color:#1a1a2e;border:none;border-radius:8px;cursor:pointer;font-weight:700;transition:transform .2s,background .2s}.click-overlay .start-btn:hover{background:#3db892;transform:scale(1.05)}.click-overlay .start-btn:disabled{background:#666;cursor:not-allowed;transform:none}@media (max-width:900px){.main-content{flex-direction:column}.repl-panel{width:100%}}.source-indicator{padding:5px 10px;background:#0f3460;border-radius:4px;font-size:12px;color:#4ecca3}.source-indicator.hidden{display:none}.source-indicator a{color:#667eea}.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.8);display:flex;justify-content:center;align-items:center;z-index:100}.modal-overlay.hidden{display:none}.modal{background:#16213e;padding:25px;border-radius:12px;max-width:500px;width:90%;border:2px solid #e94560}.modal h2{margin:0 0 15px 0;color:#e94560}.modal p{color:#888;margin:10px 0;font-size:14px}.modal input[type=text]{width:100%;padding:12px;background:#0f0f23;border:1px solid #333;color:#4ecca3;font-family:monospace;font-size:13px;border-radius:4px;margin:10px 0}.modal-buttons{display:flex;gap:10px;margin-top:15px}.modal-buttons button{flex:1;padding:10px;border:none;border-radius:6px;cursor:pointer;font-weight:600;transition:all .2s}.modal .copy-btn{background:#4ecca3;color:#1a1a2e}.modal .close-btn{background:#666;color:#fff}</style></head><body><div class=container><header><div class=header-left><h1><a href=/ >McRogueFace</a></h1><span class=tagline>Playground</span> <span class="hidden source-indicator"id=sourceIndicator></span></div><div id=status>Downloading...</div></header><div class=spinner id=spinner></div><div class=main-content><div class=game-panel><canvas class=emscripten id=canvas oncontextmenu=event.preventDefault() tabindex=-1></canvas><div class=click-overlay id=clickOverlay><h2>McRogueFace Playground</h2><p>Code snippets run unmodified in <a href=https://github.com/jmccardle/McRogueFace target=_blank>McRogueFace for Linux or Windows Desktop</a></p><p id=overlayStatus>Loading engine...</p><button id=startBtn class=start-btn disabled>Loading...</button></div></div><div class=repl-panel id=replPanel><div class=repl-header><div class=repl-title><span class="status-busy status-indicator"id=interpreterStatus title=Initializing...></span><h3>Python REPL</h3></div><div class=repl-buttons><button id=runBtn disabled>Run</button> <button id=shareBtn>Share</button> <button id=resetBtn disabled>Reset</button> <button id=clearBtn>Clear</button></div></div><div class=editor-container><textarea id=codeEditor></textarea></div><div class=repl-output-header><span>Output</span> <span class=shortcut-hint>Ctrl+Enter to run | Ctrl+Up/Down for history</span></div><div id=replOutput></div></div></div><div id=output></div></div><div class="hidden modal-overlay"id=shareModal><div class=modal><h2>Share Your Code</h2><p>Copy this URL to share your playground:</p><input id=shareUrl onclick=this.select() readonly><p id=shareSize style=font-size:12px></p><div class=modal-buttons><button id=copyBtn class=copy-btn>Copy to Clipboard</button> <button id=closeModalBtn class=close-btn>Close</button></div></div></div><script>const CONFIG={playgroundUrl:window.location.origin,shortUrl:window.location.origin,playgroundPath:window.location.pathname.replace(/\/[^\/]*$/,""),maxCodeSize:16384,githubApiBase:"https://api.github.com"};async function parseUrlFragment(){const t=window.location.hash.slice(1);if(!t)return null;const e=new URLSearchParams(t);if(e.has("src"))try{const t=e.get("src"),n=LZString.decompressFromEncodedURIComponent(t);if(n)return{type:"inline",code:n}}catch(t){console.error("Failed to decompress code:",t)}if(e.has("gist")){return{type:"gist",gistId:e.get("gist"),file:e.get("file")}}return null}async function loadGist(t,e){const n=t.includes("/")?t.split("/").pop():t;try{const t=await fetch(`${CONFIG.githubApiBase}/gists/${n}`);if(!t.ok)throw new Error(`Gist not found (${t.status})`);const r=await t.json(),o=Object.values(r.files);let i=null;return e&&(i=o.find((t=>t.filename===e))),i||(i=o.find((t=>t.filename.endsWith(".py")))),i||(i=o[0]),{code:i.content,filename:i.filename,gistUrl:r.html_url,owner:r.owner?.login||"anonymous",description:r.description}}catch(t){throw console.error("Failed to load gist:",t),t}}function generateShareUrl(t){const e=LZString.compressToEncodedURIComponent(t);return{url:`${CONFIG.shortUrl}${CONFIG.playgroundPath||""}/#src=${e}`,originalSize:t.length,compressedSize:e.length,ratio:(e.length/t.length*100).toFixed(1)}}var statusElement=document.getElementById("status"),spinnerElement=document.getElementById("spinner"),outputElement=document.getElementById("output"),canvasElement=document.getElementById("canvas"),replOutput=document.getElementById("replOutput"),runBtn=document.getElementById("runBtn"),shareBtn=document.getElementById("shareBtn"),resetBtn=document.getElementById("resetBtn"),clearBtn=document.getElementById("clearBtn"),interpreterStatus=document.getElementById("interpreterStatus"),sourceIndicator=document.getElementById("sourceIndicator"),clickOverlay=document.getElementById("clickOverlay"),startBtn=document.getElementById("startBtn"),overlayStatus=document.getElementById("overlayStatus"),shareModal=document.getElementById("shareModal"),shareUrlInput=document.getElementById("shareUrl"),shareSizeEl=document.getElementById("shareSize"),copyBtn=document.getElementById("copyBtn"),closeModalBtn=document.getElementById("closeModalBtn"),editor=CodeMirror.fromTextArea(document.getElementById("codeEditor"),{mode:"python",theme:"dracula",lineNumbers:!0,indentUnit:4,tabSize:4,indentWithTabs:!1,electricChars:!0,matchBrackets:!0}),defaultCode='import mcrfpy\n\n# the default "playground" scene\nscene = mcrfpy.current_scene\n\n# Frame:\nframe = mcrfpy.Frame((10, 10), (50, 50), fill_color=(30,30,80))\nscene.children.append(frame)\n\n# Caption:\ncaption = mcrfpy.Caption((80,10), text="Hello\\nMcRogueFace!", font_size=32) # uses default font\nscene.children.append(caption)\n\n# Sprite:\nsprite = mcrfpy.Sprite((150, 150), sprite_index=84, scale=8.0) # uses default sprite sheet\nscene.children.append(sprite)\n\n# Grid:\ngrid = mcrfpy.Grid((694,10), (320,320), grid_size=(10,10), zoom=2.0)\nscene.children.append(grid)\n# place entities on grid squares\nmcrfpy.Entity((4,5), sprite_index=85, grid=grid) # uses default sprite sheet\nmcrfpy.Entity((5,9), sprite_index=87, grid=grid)\nmcrfpy.Entity((3,7), sprite_index=89, grid=grid)\n# fill with some dirt\nimport random\nfor x in range(10):\n    for y in range(10):\n        # mostly 0 for plain dirt, with two variations\n        grid[x,y].tilesprite = random.choice([0, 0, 0, 0, 0, 0, 12, 24])\n\n\n# make the wizard sprite clickable\ndef poke(position, mousebtn, inputstate):\n    if inputstate != mcrfpy.InputState.PRESSED:\n        return\n    say = random.choice(["oof", "ouch", "uff"])\n    new_txt = mcrfpy.Caption(position, text=say)\n    scene.children.append(new_txt)\n    done = lambda *args: scene.children.remove(new_txt)\n    new_txt.animate("y", # property\n                    -100, # target value\n                    10.0 + random.randint(-4, 2), # duration\n                    callback=done # called on completion\n                   )\n    new_txt.animate("x", position.x + random.randint(-70, +270), 5.5)\n    new_txt.animate("fill_color.a", 0, 5.5)\n    new_txt.animate("rotation", random.randint(-85, 85), 5.5, mcrfpy.Easing.EASE_OUT_QUAD)\nsprite.on_click = poke\n\n# make the wizard sprite moveable\ndef keypress(key, inputstate):\n    actions = { mcrfpy.Key.W: mcrfpy.Vector(0, -10),\n                mcrfpy.Key.A: mcrfpy.Vector(-10, 0),\n                mcrfpy.Key.S: mcrfpy.Vector(0, 10),\n                mcrfpy.Key.D: mcrfpy.Vector(10, 0) }\n    if inputstate != mcrfpy.InputState.PRESSED:\n        return\n    if key in actions:\n        sprite.pos += actions[key]\n\nscene.on_key = keypress\n\nprint(mcrfpy.current_scene.children)\n\n# Press F3 for stats\n\n# create a new scene and switch to it:\n#new_scene = mcrfpy.Scene("test")\n#new_scene.activate()';editor.setValue(defaultCode);var cmElement=editor.getWrapperElement();cmElement.addEventListener("keydown",(function(t){t.stopPropagation(),t.ctrlKey&&"Enter"===t.key&&(t.preventDefault(),runBtn.disabled||runCode()),t.ctrlKey&&"ArrowUp"===t.key&&(t.preventDefault(),navigateHistory(-1)),t.ctrlKey&&"ArrowDown"===t.key&&(t.preventDefault(),navigateHistory(1))}),!1),cmElement.addEventListener("keyup",(function(t){t.stopPropagation()}),!1),cmElement.addEventListener("keypress",(function(t){t.stopPropagation()}),!1);var cmdHistory=[],historyIndex=-1,currentInput="";function navigateHistory(t){0!==cmdHistory.length&&(-1===historyIndex&&(currentInput=editor.getValue()),(historyIndex+=t)<-1?historyIndex=-1:historyIndex>=cmdHistory.length&&(historyIndex=cmdHistory.length-1),-1===historyIndex?editor.setValue(currentInput):editor.setValue(cmdHistory[cmdHistory.length-1-historyIndex]),editor.setCursor(editor.lineCount(),0))}async function init(){const t=await parseUrlFragment();if(t)if("inline"===t.type)editor.setValue(t.code),sourceIndicator.textContent="Loaded from shared URL",sourceIndicator.classList.remove("hidden");else if("gist"===t.type){editor.setValue("# Loading gist...");try{const e=await loadGist(t.gistId,t.file);editor.setValue(e.code),sourceIndicator.innerHTML=`From: <a href="${e.gistUrl}" target="_blank">${e.owner}/${e.filename}</a>`,sourceIndicator.classList.remove("hidden")}catch(t){editor.setValue(`# Failed to load gist: ${t.message}\n# Check the console for details.`)}}}canvasElement.width=1024,canvasElement.height=768;var Module={print:function(t){arguments.length>1&&(t=Array.prototype.slice.call(arguments).join(" ")),console.log(t),outputElement.textContent+=t+"\n",outputElement.scrollTop=outputElement.scrollHeight},printErr:function(t){arguments.length>1&&(t=Array.prototype.slice.call(arguments).join(" ")),console.error(t),outputElement.textContent+="[ERR] "+t+"\n",outputElement.scrollTop=outputElement.scrollHeight},canvas:canvasElement,setStatus:function(t){if(Module.setStatus.last||(Module.setStatus.last={time:Date.now(),text:""}),t!==Module.setStatus.last.text){var e=t.match(/([^(]+)\((\d+(\.\d+)?)\/(\d+)\)/),n=Date.now();e&&n-Module.setStatus.last.time<30||(Module.setStatus.last.time=n,Module.setStatus.last.text=t,e&&(t=e[1]),statusElement.innerHTML=t)}},totalDependencies:0,monitorRunDependencies:function(t){this.totalDependencies=Math.max(this.totalDependencies,t),Module.setStatus(t?"Preparing... ("+(this.totalDependencies-t)+"/"+this.totalDependencies+")":"All downloads complete.")},onRuntimeInitialized:function(){console.log("Emscripten runtime initialized"),spinnerElement.style.display="none",runBtn.disabled=!1,resetBtn.disabled=!1,window.FS=Module.FS,window.runPython=function(t){return Module.ccall("run_python_string_with_output","string",["string"],[t])},window.resetGame=function(){return Module.ccall("reset_python_environment","number",[],[])},window.getPythonState=function(){return Module.ccall("get_python_state","string",[],[])},window.clearPythonError=function(){Module.ccall("clear_python_error",null,[],[])},window.getPythonGlobalsCount=function(){return Module.ccall("get_python_globals_count","number",[],[])},updateInterpreterStatus(),appendToOutput("Python REPL ready. Enter code and click Run (or Ctrl+Enter).","success"),appendToOutput("Tip: Use Ctrl+Up/Down to navigate command history.","input"),overlayStatus.textContent="Engine ready!",startBtn.textContent="Click to Run",startBtn.disabled=!1,setTimeout((function(){canvasElement.focus(),window.dispatchEvent(new Event("resize"))}),100)}};function updateInterpreterStatus(){if(!window.getPythonState)return interpreterStatus.className="status-indicator status-busy",void(interpreterStatus.title="Initializing...");var t=window.getPythonState();"OK"===t?(interpreterStatus.className="status-indicator status-ok",interpreterStatus.title="Interpreter ready"):"NOT_INITIALIZED"===t?(interpreterStatus.className="status-indicator status-busy",interpreterStatus.title="Python not initialized"):(interpreterStatus.className="status-indicator status-error",interpreterStatus.title=t)}function appendToOutput(t,e){var n=document.createElement("span");n.className=e||"",n.textContent=t+"\n",replOutput.appendChild(n),replOutput.scrollTop=replOutput.scrollHeight}function runCode(){var t=editor.getValue();if(t.trim()){0!==cmdHistory.length&&cmdHistory[cmdHistory.length-1]===t||cmdHistory.push(t),historyIndex=-1,appendToOutput(">>> "+t.split("\n")[0]+(t.includes("\n")?"...":""),"input");var e=window.getPythonState();"OK"!==e&&"NOT_INITIALIZED"!==e&&(appendToOutput("Warning: Clearing previous error state...","warning"),window.clearPythonError(),updateInterpreterStatus());try{window.runPython("_reset()");var n=window.runPython(t);updateInterpreterStatus(),n&&(n.includes("Traceback")||n.includes("Error:")||n.includes("Error\n")||n.startsWith("Internal REPL Error:")?appendToOutput(n,"error"):appendToOutput(n,"success"))}catch(t){appendToOutput("JavaScript Error: "+t.toString(),"error"),updateInterpreterStatus()}}}function resetEnvironment(){appendToOutput(">>> Resetting environment...","input"),window.clearPythonError&&window.clearPythonError();try{window.resetGame(),updateInterpreterStatus(),appendToOutput("Environment reset.","success")}catch(t){appendToOutput("Reset error: "+t.toString(),"error"),updateInterpreterStatus()}}function clearOutput(){replOutput.innerHTML=""}function showShareModal(){const t=editor.getValue();if(t.length>CONFIG.maxCodeSize)return void alert(`Code is too large (${(t.length/1024).toFixed(1)} KB). Maximum is ${CONFIG.maxCodeSize/1024} KB.\n\nConsider using a GitHub Gist for larger code.`);const e=generateShareUrl(t);shareUrlInput.value=e.url,shareSizeEl.textContent=`${e.originalSize} bytes -> ${e.compressedSize} chars (${e.ratio}% of original)`,e.url.length>2e3&&(shareSizeEl.textContent+=" Warning: URL is long - may not work in all browsers"),shareModal.classList.remove("hidden")}Module.setStatus("Downloading..."),window.onerror=function(t){Module.setStatus("Error! See console for details."),spinnerElement.style.display="none"},"undefined"==typeof resolveGlobalSymbol&&(window.resolveGlobalSymbol=function(t,e){return{sym:Module["_"+t]||Module[t],type:"function"}}),canvasElement.addEventListener("click",(function(){canvasElement.focus()})),canvasElement.addEventListener("mousedown",(function(){document.activeElement!==canvasElement&&canvasElement.focus()})),copyBtn.addEventListener("click",(function(){shareUrlInput.select(),navigator.clipboard.writeText(shareUrlInput.value).then((function(){copyBtn.textContent="Copied!",setTimeout((function(){copyBtn.textContent="Copy to Clipboard"}),2e3)})).catch((function(){document.execCommand("copy"),copyBtn.textContent="Copied!",setTimeout((function(){copyBtn.textContent="Copy to Clipboard"}),2e3)}))})),closeModalBtn.addEventListener("click",(function(){shareModal.classList.add("hidden")})),shareModal.addEventListener("click",(function(t){t.target===shareModal&&shareModal.classList.add("hidden")})),document.addEventListener("keydown",(function(t){"Escape"!==t.key||shareModal.classList.contains("hidden")||shareModal.classList.add("hidden")})),runBtn.addEventListener("click",runCode),shareBtn.addEventListener("click",showShareModal),resetBtn.addEventListener("click",resetEnvironment),clearBtn.addEventListener("click",clearOutput),startBtn.addEventListener("click",(function(){clickOverlay.classList.add("hidden"),canvasElement.focus(),window.runPython&&runCode()})),init()</script><script src=mcrogueface.js async></script></body></html>